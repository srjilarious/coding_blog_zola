
<!DOCTYPE html>
<html lang="en">
<head>
  <script src="https://www.walknsqualk.com/js/theme.min.js" integrity="sha384-pb++s6uBRKaQv+iAXpgA/H3IlpLZdO14tTwuCI7uXmz4aaZdByoCcM+6BhynMq/1"></script>
  <link rel="stylesheet" href="https://www.walknsqualk.com/abridge.css?h=f3cf078b0dda0efcc1e1" />
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="base" content="https://www.walknsqualk.com/" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="theme-color" content="#333333" />
  <meta name="msapplication-TileColor" content="#333333" />
  <link rel="manifest" href="https://www.walknsqualk.com/manifest.min.json" />
  <link rel="mask-icon" href="https://www.walknsqualk.com/safari-pinned-tab.svg" color="#ff9900" />
  <link rel="apple-touch-icon" sizes="180x180" href="https://www.walknsqualk.com/apple-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="https://www.walknsqualk.com/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="https://www.walknsqualk.com/favicon-16x16.png" />
  <link rel="alternate" type="application/atom+xml" title="Walk N&#x27; Squawk Atom Feed" href="https://www.walknsqualk.com/atom.xml" />
  <meta name="robots" content="index, follow" />
  <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
  <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
  <title>Hacking Final Fantasy 1 on the NES | Walk N' Squawk</title>
  <meta name="author" content="Jeff DeWall" />
  <meta name="copyright" content="Walk N&#x27; Squawk" />
  <meta name="description" content="A Zig and Elixir Coding Blog, with some FPGA and Japanese content as well." />
  <link rel="canonical" href="https://www.walknsqualk.com/002-hacking-final-fantasy-1-on-nes/" />
  <meta name="keywords" content="Zig, Rust, Elixir, Python, Japanese, German, Coding" />
  <meta name="google-site-verification" content="Your Google Site verification code." />
  <meta name="msvalidate.01" content="Your Bing Site verification code." />
  <meta property="og:url" content="https://www.walknsqualk.com/002-hacking-final-fantasy-1-on-nes/" />
  <meta name="twitter:url" content="https://www.walknsqualk.com/002-hacking-final-fantasy-1-on-nes/" />
  <meta property="og:description" content="A Zig and Elixir Coding Blog, with some FPGA and Japanese content as well." />
  <meta name="twitter:description" content="A Zig and Elixir Coding Blog, with some FPGA and Japanese content as well." />
  <meta property="og:title" content="Hacking Final Fantasy 1 on the NES | Walk N&#x27; Squawk" />
  <meta name="twitter:title" content="Hacking Final Fantasy 1 on the NES | Walk N&#x27; Squawk" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:image" content="https://www.walknsqualk.com/banner.png" />
  <meta property="og:image" content="https://www.walknsqualk.com/banner.png" />
  <meta property="og:site_name" content="Walk N&#x27; Squawk" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:type" content="website" />
  <meta property="og:updated_time" content="2017-03-19" />
  <meta name="twitter:site" content="@your-user-name" />
  <meta name="twitter:creator" content="@your-user-name" />
  <script defer src="https://www.walknsqualk.com/js/abridge.min.js?h=e0f9a881a665c86cce9c" integrity="sha384-QF67y7RnPkuDrJNQqn3/7nYxqxWkW/qHI7zN0WTES1aXbf+TotoByRBb835fUE6U"></script>
  <noscript><link rel="stylesheet" href="https://www.walknsqualk.com/nojs.css" /></noscript>
</head>
<body>
  <header>
    <nav>
      <div><big><a href="https://www.walknsqualk.com" title="Walk N&#x27; Squawk"><img src="https://www.walknsqualk.com//logo.png" alt="WalkNSqualk" width="48" height="48" /> Walk N' Squalk</a></big></div>
      <div>

        <div>
          <ul><li><a class="s110" href="https://www.walknsqualk.com/archive/"> Posts </a></li><li><a class="s110" href="https://www.walknsqualk.com/tags/"> Tags </a></li><li><i type="reset" id="mode" class="js svgs adjust"></i></ul>
        </div>

        <div>
          <div>
            <form autocomplete=off class="js" name="goSearch" id="searchbox">
              <div class="searchd">
                <input id="searchinput" type="text" placeholder="Search" title="Search" />
                <button type="submit" title="Search" class="svgs svgm search"></button>
              </div>
              <div class="results"><div id="suggestions"></div></div>
            </form>
          </div>
        </div>

      </div>
    </nav>
    <hr />
  </header>
  <main>
    <article>
      <h1><a href="https://www.walknsqualk.com/002-hacking-final-fantasy-1-on-nes/">Hacking Final Fantasy 1 on the NES</a></h1>

      <span class="s95"> Jeff DeWall <span class="rpad"></span> 9 min read <span class="rpad"></span> March 19, 2017 <span class="rpad"></span> #<a href="https://www.walknsqualk.com/tags/retrogaming/">RetroGaming</a>  #<a href="https://www.walknsqualk.com/tags/hacking/">Hacking</a> </span>

    


<p>A few years ago I was inspired to hack around on some of my old favorite NES games after watching the video from Double Fine where the developer Brandon Dillon hacks around on the original Legend of Zelda.  You can watch the video <a rel="noopener" target="_blank" href="https://youtu.be/FolqIgQRtl0?t=1s">here</a>.</p>
<p>I decided I wanted to hack Final Fantasy 1, one of my favorite games growing up, that I put in more than 100 hours playing.  I used fceux as my NES emulator, same as in the video and followed mostly the same patterns.</p>
<p>I kept some notes on how I did it and thought others might find the process as interesting and fun as I did.  I ended up losing most of the notes from a few years ago, so I went back and rediscovered the different memory locations and values to use again.</p>
<p>I searched in the RAM Search window for values, particularly as something in-game would change, such as when you buy a weapon or a spell, in order to track down the correct memory locations.  Then I would use the Hex Editor tool to look at the NES RAM and try poking different locations.</p>
<p>Note that values that need more than one byte are stored little-endian, so the lower byte shows up first in memory.</p>
<h2 id="character-data-and-stats">Character Data and Stats</h2>
<p>The character data is organized into four blocks, once for each character, one after the other starting at 0x6100.  I was able to find this by searching for my character's names in RAM.  The trick is finding the value associated with the letters, which you can do by looking at the PPU memory and determining what tile goes to what letter.</p>
 <img src="ff1_hack_ppu.png" alt="ff1_hack_ppu" width="535" height="427" loading="lazy" />
<p>You can see that a capital 'A' is mapped to 0x8A.  I named my first character 'AAAA' so searching through the Hex Editor in FCEUX for the hex "8a8a8a8a" brings us right to the first character's block of data:</p>
 <img src="ff1_hack_hex_char_data.png" alt="Character Name in Hex Editor" width="678" height="492" loading="lazy" />
<table><thead><tr><th>Address</th><th>Character Data</th></tr></thead><tbody>
<tr><td>0x6100 - 0x613f</td><td>1st character</td></tr>
<tr><td>0x6140 - 0x617f</td><td>2nd character</td></tr>
<tr><td>0x6180 - 0x61bf</td><td>3rd character</td></tr>
<tr><td>0x61c0 - 0x61ff</td><td>4th character</td></tr>
</tbody></table>
<p>Some interesting locations within a character block:</p>
<table><thead><tr><th>Address</th><th>Attribute</th></tr></thead><tbody>
<tr><td>0x0</td><td>character type</td></tr>
<tr><td>0x1</td><td>character alive state (0: alive, 1:dead)</td></tr>
<tr><td>0x2 - 0x5</td><td>character name (using PPU tile indices)</td></tr>
<tr><td>0x7 - 0x9</td><td>experience points</td></tr>
<tr><td>0xa - 0xb</td><td>current hit points</td></tr>
<tr><td>0xc - 0xd</td><td>max hit points</td></tr>
<tr><td>0x10 - 0x14</td><td>Str, Agl, Int, Vit, Luck</td></tr>
<tr><td>0x20 - 0x23</td><td>Damage, Hit%, Absorb, Evade %</td></tr>
</tbody></table>
<p>I found many of the above locations by looking at the Stats section for a character and then looking for the hex converted values within the block.  For instance, looking for my first character's Str and Agl of 20, and 5 was a matter of looking for the hex values 14, 05 and finding them on the second line of the data block.  Then I messed with the values and saw what changed.</p>
<p>When you start the game, you characters are child versions of their classes: fighter, black mage, etc.  Later in the game, after you get the Rat's Tail, they become adults: knight, black wizard etc.  You can increase the character's type value by 6 (the total number of character classes), and they will change to their adult version right away.</p>
<h2 id="magic">Magic</h2>
<p>What magic spells a character has, and the current/max number of spells per level are stored in blocks for each character starting at 0x6300:</p>
<table><thead><tr><th>Address</th><th>Character Magic Data</th></tr></thead><tbody>
<tr><td>0x6300 - 0x632f</td><td>1st character</td></tr>
<tr><td>0x6340 - 0x636f</td><td>2nd character</td></tr>
<tr><td>0x6380 - 0x63af</td><td>3rd character</td></tr>
<tr><td>0x63c0 - 0x63ef</td><td>4th character</td></tr>
</tbody></table>
<p>The first 32 bytes are what spells the character has for each level.  Each level gets 4 bytes, with the first 3 being the spell in that level's slot, and the 4th byte being 0.  White spells for a level are numbered 0-4 and black spells are 5-8.</p>
<p>The last 16 bytes within the block are 2 bytes for each level, with the first byte being the current number of casts left for the level, with the 2nd byte being the max.</p>
<p>Here you can see a white wizard that I've given the first 3 spells of each level to (the repeating 01 02 03) and that has 9 / 9 casts for each level:</p>
 <img src="ff1_hack_magic_data_hex.png" alt="Character Magic Data in Hex Editor" width="628" height="280" loading="lazy" />
<p>And the white wizard's magic table in-game looks like:</p>
 <img src="ff1_hack_white_mage_table.png" alt="Character Magic Table in Game" width="512" height="448" loading="lazy" />
<h3 id="white-magic-spell-table">White Magic Spell table</h3>
<p>| 1 | 2 | 3 | 4
--- | --- | --- | --- | ---
Lvl 1 | cure | harm | fog | ruse
Lvl 2 | lamp | mute | alit | invs
Lvl 3 | cur2 | hrm2 | afir | heal
Lvl 4 | pure | fear | aice | amut
Lvl 5 | cur3 | life | hrm3 | hel2
Lvl 6 | soft | exit | fog2 | inv2
Lvl 7 | cur4 | hrm4 | arub | hel3
Lvl 8 | lif2 | fade | wall | xfer</p>
<h3 id="black-magic-spell-table">Black Magic Spell table</h3>
<p>| 5 | 6 | 7 | 8
--- | --- | --- | --- | ---
Lvl 1 | fire | slep | lcok | lit
Lvl 2 | ice | dark | tmpr | slow
Lvl 3 | fir2 | hold | lit2 | lok2
Lvl 4 | slp2 | fast | conf | ice2
Lvl 5 | fir3 | bane | warp | slo2
Lvl 6 | lit3 | rub | qake | stun
Lvl 7 | ice3 | brak | sabr | blnd
Lvl 8 | nuke | stop | zap! | xxxx</p>
<h2 id="weapons-and-armor">Weapons and Armor</h2>
<p>By buying a rapier and then equipping/unequipping I found the equip memory to be at 0x0300, there are 16 bytes available, matching the 4 slots for each character. Each weapon and armor has a number and to be equipped is a matter of setting the highest bit.  For example, if the rapier is 04, then 84 means an equipped rapier.</p>
<p>Interestingly, the memory seems to be used for the equip menu, and is mirrored at 0x0b00, 0x1300, and 0x1b00 as well.  This same memory is used when equipping armor, so you can set the values while equipping, and they will stick when you leave the menu.</p>
<h3 id="weapons-list">Weapons List</h3>
<table><thead><tr><th>Hex Code</th><th>Weapon</th><th>Hex Code</th><th>Weapon</th></tr></thead><tbody>
<tr><td>00</td><td>Nothing</td><td>15</td><td>Ice Sword</td></tr>
<tr><td>01</td><td>Wooden Nunchucks</td><td>16</td><td>Dragon sword</td></tr>
<tr><td>02</td><td>Small dagger</td><td>17</td><td>Giant sword</td></tr>
<tr><td>03</td><td>Wooden staff</td><td>18</td><td>Sun Sword</td></tr>
<tr><td>04</td><td>Rapier</td><td>19</td><td>Coral sword</td></tr>
<tr><td>05</td><td>Iron Hammer</td><td>1a</td><td>Were Sword</td></tr>
<tr><td>06</td><td>Short Sword</td><td>1b</td><td>Rune sword</td></tr>
<tr><td>07</td><td>Hand Axe</td><td>1c</td><td>Power staff</td></tr>
<tr><td>08</td><td>Scimatar</td><td>1d</td><td>Light Axe</td></tr>
<tr><td>09</td><td>Iron Nunchucks</td><td>1e</td><td>Heal staff</td></tr>
<tr><td>0a</td><td>Large Knfie</td><td>1f</td><td>Mage staff</td></tr>
<tr><td>0b</td><td>Iron Staff</td><td>20</td><td>Defense ?</td></tr>
<tr><td>0c</td><td>Sabre</td><td>21</td><td>Wizard staff</td></tr>
<tr><td>0d</td><td>Long Sword</td><td>22</td><td>Vorpal</td></tr>
<tr><td>0e</td><td>Great Axe</td><td>23</td><td>CatClaw</td></tr>
<tr><td>0f</td><td>Falchon</td><td>24</td><td>Thor Hammer</td></tr>
<tr><td>10</td><td>Silver dagger</td><td>25</td><td>Bane Sword</td></tr>
<tr><td>11</td><td>Silver Sword</td><td>26</td><td>Katana</td></tr>
<tr><td>12</td><td>Silver Hammer</td><td>27</td><td>XCalber</td></tr>
<tr><td>13</td><td>Silver Axe</td><td>28</td><td>Masmune</td></tr>
<tr><td>14</td><td>Flame sword</td><td></td><td></td></tr>
</tbody></table>
<h3 id="armor-list">Armor List</h3>
<table><thead><tr><th style="text-align: right">Hex Value</th><th>Armor</th><th style="text-align: right">Hex Value</th><th>Armor</th></tr></thead><tbody>
<tr><td style="text-align: right">01</td><td>Cloth</td><td style="text-align: right">15</td><td>Ice shield</td></tr>
<tr><td style="text-align: right">02</td><td>Wooden Armor</td><td style="text-align: right">16</td><td>Opal shield</td></tr>
<tr><td style="text-align: right">03</td><td>Chain Armor</td><td style="text-align: right">17</td><td>Aegis Shield</td></tr>
<tr><td style="text-align: right">04</td><td>Iron Armor</td><td style="text-align: right">18</td><td>Buckler</td></tr>
<tr><td style="text-align: right">05</td><td>Steel Armor</td><td style="text-align: right">19</td><td>ProCape</td></tr>
<tr><td style="text-align: right">06</td><td>Silver Armor</td><td style="text-align: right">1a</td><td>Cap</td></tr>
<tr><td style="text-align: right">07</td><td>Flame Armor</td><td style="text-align: right">1b</td><td>Wooden helmet</td></tr>
<tr><td style="text-align: right">08</td><td>Ice Armor</td><td style="text-align: right">1c</td><td>Iron helmet</td></tr>
<tr><td style="text-align: right">09</td><td>Opal Armor</td><td style="text-align: right">1d</td><td>Silver helmet</td></tr>
<tr><td style="text-align: right">0A</td><td>Dragon Armor</td><td style="text-align: right">1e</td><td>Opal helmet</td></tr>
<tr><td style="text-align: right">0b</td><td>Copper ring</td><td style="text-align: right">1f</td><td>Heal helmet</td></tr>
<tr><td style="text-align: right">0c</td><td>Silver ring</td><td style="text-align: right">20</td><td>Ribbon</td></tr>
<tr><td style="text-align: right">0d</td><td>Gold ring</td><td style="text-align: right">21</td><td>Gloves</td></tr>
<tr><td style="text-align: right">0e</td><td>Opal Ring</td><td style="text-align: right">22</td><td>Copper bracer</td></tr>
<tr><td style="text-align: right">0f</td><td>White Shirt</td><td style="text-align: right">23</td><td>Iron bracer</td></tr>
<tr><td style="text-align: right">10</td><td>Black shirt</td><td style="text-align: right">24</td><td>Silver bracer</td></tr>
<tr><td style="text-align: right">11</td><td>Wooden shield</td><td style="text-align: right">25</td><td>Zeus bracer</td></tr>
<tr><td style="text-align: right">12</td><td>Iron shield</td><td style="text-align: right">26</td><td>Power bracer</td></tr>
<tr><td style="text-align: right">13</td><td>Silver shield</td><td style="text-align: right">27</td><td>Opal bracer</td></tr>
<tr><td style="text-align: right">14</td><td>Flame shield</td><td style="text-align: right">28</td><td>ProRing</td></tr>
</tbody></table>
<p>Playing around with the values, I ended up with weapons like:</p>
 <img src="ff1_hack_weapons.png" alt="Weapons in Game" width="512" height="448" loading="lazy" />
<p>and my armor setup looked like this, although I wasn't trying to find the best setup:</p>
 <img src="ff1_hack_armor.png" alt="Armor in Game" width="512" height="448" loading="lazy" />
<h2 id="other-misc-game-data">Other Misc Game Data</h2>
<p>I ended up finding some general game data by searching for the gold amount of my party.
Gold is stored in at least 3 bytes at 0x601c - 0x601e (highest byte is 601e).  Setting the value above 0x0F423F (999,999) will cause you to have more gold when buying items, but sometimes the display value can be messed up and display some random letters like 999,9N2.  I didn't dig much more into this as having more gold wasn't necessary.</p>
<p>Memory location 0x6016, when changed to non-zero, triggers the cut scene when the heroes first cross the bridge after defeating Garland.</p>
<p>By writing 1's to the values in the generic game data block.  I narrowed down the light orb booleans to the addresses: 0x6032-0x6035. A zero means the orb has not yet been obtained, and any other values shows the orb as shining.</p>
<p>The character's world position: 0x0027 xpos, 0x0028 ypos.  You can teleport the player around by changing these values.  If you do so the map doesn't update automatically, but you'll see the new location tiles scroll in as you start to walk around or you can do a screen refresh by going into the party menu and then leaving.</p>
<p>If you teleport onto a location, like a mountain or water, you'll be stuck, but then you just need to teleport yourself by changing the world position some more.</p>
<p>I wanted to find the airship right away, so I looked at a map online of FF1 and guesstimated where the world pos should be.  I teleported myself in the desert where the airship is, placing myself nearby at 0xD1, 0xE5 for the x and y coordinates respectively.</p>
<p>Then looking back at the general game data block at 0x6000, I noticed a pair of coordinates DD, ED at 0x6005-0x6006 that looked like they could belong to the airship world position. So I tried setting the values around that to 1 to see if that would enable to the airship and setting the byte just before, which was 0, to 1, caused it to increment to 1f and the airship to appear at 0xDD, 0xED.</p>
<p>In a new game, you could simply move the airship to your world position and enable it and it will appear right next to you.</p>
<h2 id="wrapping-up">Wrapping up</h2>
<p>This was a fun way to spend a few hours on a rainy Saturday revisiting one of my favorite games from my youth without investing as many hours playing.  It does make me feel a bit less inclined to play old RPGs now, knowing that I'm grinding just to increase a few bytes of memory.</p>
<p>I hope you've found this interesting and try hacking around on an old game from your past and share the details.  Happy hacking!</p>
<div id="commento"></div>
<script src="https://cdn.commento.io/js/commento.js"></script>

      <nav>
        <div>
          <a href="https://www.walknsqualk.com/005-elixir-on-wsl/">&#8249; Elixir on Windows Subsystem for Linux</a>
        </div>
        <div>
          <a href="https://www.walknsqualk.com/001-setting-up-hugo-blog-on-gitlab/"> Setting up a Hugo-based Blog on GitLab &#8250;</a>
        </div>
      </nav>
    </article>
  </main>
  <footer>
    <hr />
    <div class="c">
      <nav class="tpad"><div><a type="application/atom+xml" href="https://www.walknsqualk.com/atom.xml" target="_blank" title="Walk N&#x27; Squawk Atom Feed"><i type="Button" class="svg rss" title="Walk N&#x27; Squawk Atom Feed"></i></a><a class="js m-protected" href="#c3JqaWxhcmlvdXNAZmFzdG1haWwubmV0" target="_blank" title="Mail"><i type="Button" class="svg mail" title="Mail"></i></a><a href="https://mastodon.social/@srjilarious" target="_blank" title="Mastodon" rel="me"><i type="Button" class="svg mastodon" title="Mastodon"></i></a><a href="https://gitlab.com/sr.jilarious/" target="_blank" title="Gitlab"><i type="Button" class="svg gitlab" title="Gitlab"></i></a><a href="https://github.com/srjilarious/" target="_blank" title="Github"><i type="Button" class="svg github" title="Github"></i></a></div></nav>
      <nav class="vpad">
        <a class="rpad s90" href="https://www.walknsqualk.com/about/"> About </a>
        <a class="rpad s90" href="https://www.walknsqualk.com/contact/"> Contact </a>
        <a class="rpad s90" href="https://www.walknsqualk.com/privacy/"> Privacy </a>
        <a class="rpad s90" href="https://www.walknsqualk.com/sitemap.xml" target="_blank"> Sitemap </a>
      </nav>
      <p class="s80"> &copy; <span id="year">2024</span> Walk N' Squawk</p>
      <p class="s80">Powered by <a href="https://www.getzola.org/" target="_blank">Zola</a> & <a href="https://github.com/jieiku/abridge/" target="_blank">Abridge</a></p>
    </div>
  </footer><span class="topout">
<span class="topleft"> </span><a href="#" class="top" title="Back to Top"><i class="svgs svgh angu"></i></a>
</span>
</body>
</html>
